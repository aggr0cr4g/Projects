## 3.2.1
Experiment with VBA programming basics by creating a small macro that prints the current username and computer name 5 times using the _Environ$_ function.

**Syntax**

**Environ**( { _envstring_ | _number_ } )

 ```
Sub Document_Open()
    MyMacro
End Sub

Sub AutoOpen()
    MyMacro
End Sub

Sub MyMacro()

Dim EnvString, Indx, Msg, UserLen    ' Declare variables.
Indx = 1    ' Initialize index to 1.
Do
    EnvString = Environ(Indx)    ' Get environment variable.
    If Left(EnvString, 9) = "USERNAME=" Then    ' Check for username
        UserLen = Len(Environ("USERNAME"))
        Exit Do
    Else
        Indx = Indx + 1    ' Not USERNAME entry,
    End If    ' so increment.
Loop Until EnvString = ""

If UserLen > 0 Then
    MsgBox Environ("USERNAME")
Else
    MsgBox "No USER environment variable exists."
End If

End Sub

```
This is a little much but wanted to show a couple ways of getting to the same solution. Within the loop we are looping through the entire Environment Table and searching in the left 9 chars are a specific text. This can be used with a toLower() style of searching if the name is unknown. However, if the name is known you can just Environ("USERNAME")

## 3.2.2
1.  Create an Excel macro that runs when opening an Excel spreadsheet and executes cmd.exe using _Workbook_Open_.[15](https://portal.offensive-security.com/courses/pen-300/books-and-videos/modal/modules/client-side-code-execution-with-office/phishing-with-microsoft-office/introduction-to-vba#fn15)

