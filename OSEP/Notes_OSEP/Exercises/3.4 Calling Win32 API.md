## 3.4.1
Replicate the call to _GetUserName_ and return the answer

```
#If VBA7 Then
    Private Declare PtrSafe Function GetUserName Lib "advapi32.dll" Alias "GetUserNameA" (ByVal lpBuffer As String, ByRef nSize As Long) As Long
#Else
    Private Declare Function GetUserName Lib "advapi32.dll" Alias "GetUserNameA" (ByVal lpBuffer As String, ByRef nSize As Long) As Long
#End If


Sub MyMacro()
    Dim res As Long
    Dim MyBuff As String * 256
    Dim MySize As Long
    Dim strlen As Long
    MySize = 256
    res = GetUserName(MyBuff, MySize)
    MsgBox MyBuff
    
End Sub

```


## 3.4.2
Import the Win32 _MessageBoxA_[9](https://portal.offensive-security.com/courses/pen-300/books-and-videos/modal/modules/client-side-code-execution-with-office/executing-shellcode-in-word-memory/calling-win32-apis-from-vba#fn9) API and call it using VBA

```
#If VBA7 Then
    Private Declare PtrSafe Function MesgBox Lib "User32.dll" Alias "MessageBoxA" ( _
        ByVal hwnd As Long, _
        ByVal lpText As String, _
        ByVal lpCaption As String, _
        ByVal uType As Long) As Long
#Else
    Private Declare Function MsgBox Lib "User32.dll" Alias "MessageBox" ( _
        ByVal hwnd As Long, _
        ByVal lpText As String, _
        ByVal lpCaption As String, _
        ByVal uType As Long) As Long
#End If
Sub MyMacro()
    Dim res As Long
    Dim MyMessage As String
    Dim MyCaption As String
    Dim MyType As String
    MyMessage = "This is a Test"
    MyCaption = "Error"
    MyType = "MB_ICONWARNING | MB_CANCELTRYCONTINUE | MB_DEFBUTTON2"
    res = MesgBox(0, MyMessage, MyCaption, 0)
    
End Sub
```